language: node_js
node_js:
- '8'
dist: trusty
services:
- mongodb
- redis-server
env:
- NODE_ENV=ci PORT=3000
cache:
  directories:
  - node_modules
  - client/node_modules
install:
- npm install
- npm run build
script:
- nohup npm run start &
- sleep 3
- npm run test
deploy:
  provider: heroku
  api_key:
    secure: dNMft2mVirfUPF9VYUC5bxEQWR893Mxb17JQD7g5ZdCZ34tNoCBkClXnX1o5/mmYaS8T+pLYV2wsX98zgTHcmgbzchQdB/niCNWZwKPBZc3yTUa9BA2sXOcUTbEPstLwoZ0zUVuAmr2h5Z4wFPX3xrPai6oQ2sO/umM8HBGxStSOP2fKX17pJfk2uulxxgadNabMBPfU4ZMrkwv4/YtVIA6mfjz8KXAOaavxEr2Btz119Heh07JDoPrBFF2orFWn8mTCjuEojZQB+F1RlPl69V7xZeuGMf8ejXiD8J0aJaDcdYKPMh+aWwVqzFpXkpyi6/tkjY1kAhFDI/80IB5BDSg42fb5SYTyr4DNAj1vWN+mHscVxNKKaa5WxyQssNOrA8k/WAnYMxahuy0Xd9kCo5JhIUOQ4VUgn4WmVXlZ81S5qa02oBCEcybuRmAJyEY99zEF7iQHocWKPstxEImgKGirLP08wKBaJRfw23E76aAYYTEqYcmPD/bREvtR6YDCJQ4cgTLi7EyLl5oCqExG76VxLHOgBj2y59uyAKyIavBhogxnx7EqVwd4qwrAWzJrW5WTOD3FeCeWKaxwYoT9eL+O/v3SjV5UvSSqIOfddxQn5+8dPsXT3yUcoZRAyjhhY7GVaBSJCk117W1OlOw75ckyH/LLU7koCtrqFSMPVxs=
  app: AdvancedNodeSetup
  on:
    repo: artokun/AdvancedNodeSetup
    branch: heroku-deploy
